<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title></title>

    <link href="lib/ionic/css/ionic.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
    <link href="css/ionic.app.css" rel="stylesheet">
    -->

    <!-- ionic/angularjs js -->
    <script src="lib/ionic/js/ionic.bundle.js"></script>
    <script src="lib/pouchdb/dist/pouchdb.min.js"></script>

    <script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyA2u0eQNzCuDMdzG4opRM1ELacupQbzX28&sensor=true"></script>

    <!-- your app's js -->
    <script src="js/app.js"></script>
    <!-- cordova script (this will be a 404 during development) -->
    <script src="cordova.js"></script>

  </head>

    <body onload="onload()" ng-app="starter">

    <ion-side-menus>

      <!-- Center content -->
      <ion-side-menu-content ng-controller="toggleMenu">
        <ion-header-bar class="bar-stable">
          <button class="button button-icon icon ion-navicon" ng-click="toggleLeftSideMenu()"></button>
          <h1 class="title">Home</h1>
          <a class="button button-icon icon ion-settings" href="profile-user.html"></a>
        </ion-header-bar>

        <ion-content>
          <div id="cres"></div>

          <div ng-controller="MapController" id="map" data-tap-disabled="true"></div>

          <div class="row">
            <div class="col">

            </div>
          </div>

          <ul id="postDisplay">

          </ul>

          <div class="padding-separate"></div>
          <a href="index.html">back to index</a>
<!--
          <ion-list>
            <ion-item>
                <div class="row">
                  <div class="col col-90">
                    <p class="title-index">Title Title Title Title Title Title Title Title Title Title Title Title Title Title Title Title Title Title</p>
                  </div>
                   <div class="col col-10">
                      <img>
                   </div>
                </div>

                <div class="row">
                  <div class="col">
                    <div>{Org name}</div>
                  </div>
                </div>

                <div class="row">
                  <div class="col">
                    <div>{how far away}</div>
                  </div>
                </div>

                <div class="row">
                  <div class="col">
                      <div>details fetched from database details fetched from database details fetched from database details fetched from database </div>
                  </div>
                </div>

            </ion-item>
          </ion-list>
-->

        </ion-content>
      </ion-side-menu-content>

      <!-- Left menu -->
      <ion-side-menu side="left">
        <ion-header-bar class="bar-dark">

          <h1 class="title">Preferences</h1>

        </ion-header-bar>
        <ion-content scroll="false">


          <label class="item item-input item-select">
          <div class="input-label">
            Showing:
          </div>
          <select>
            <option>Work</option>
            <option>Volunteer</option>
            <option selected>ALL</option>
          </select>
          </label>

          <label class="item item-input item-select">
          <div class="input-label">
            Sort by:
          </div>
          <select>
            <option></option>
            <option selected>Proximity</option>
          </select>
          </label>
        </ion-content>
      </ion-side-menu>
    </ion-side-menus>



    <script>

      var dbpostings = new PouchDB('postings');
      var remoteCouch = "http://localhost:5984/postings";

//FOR MAIN.HTML


      function displayIndividualPosts(x) {
        var ul = document.getElementById("postDisplay");
        x.forEach(function(y) {
          ul.appendChild(createPost(y.doc));
        });
      }

      /*
      function createPost(z) {
        //alert(z.title + z.latlng + z.type);
        var li = document.createElement("li");
        var header = document.createElement("h3");
        var paragraph = document.createElement("p");
        var span = document.createElement("span");
        var divDisplay = document.createElement("div");
        li.appendChild(header);
        li.appendChild(divDisplay);
        header.appendChild(document.createTextNode(z.title));
        //for loop
        divDisplay.appendChild(paragraph);
        divDisplay.appendChild(span);
        divDisplay.appendChild(paragraph);
        paragraph.appendChild(document.createTextNode(z.skills));
        span.appendChild(document.createTextNode(z.address));
        paragraph.appendChild(document.createTextNode(z.latlng));

        return li;
      }
      */

      function createPost(z) {
        var li = document.createElement("ion-item");
        var header = document.createElement("h3");
        var paragraph = document.createElement("p");
        paragraph.className = "blue"; //http://stackoverflow.com/questions/1115310/how-to-add-a-class-to-dom-element-in-javascript
        var span = document.createElement("span");
          //clickable
          var a = document.createElement('a');
          var linkText = document.createTextNode("SEE MORE");
          a.appendChild(linkText);
          a.href = "org/newpost/post.html";
        var divDisplay = document.createElement("div");
        li.appendChild(header);
        li.appendChild(divDisplay);
        header.appendChild(document.createTextNode(z.title));
        //for loop
        divDisplay.appendChild(paragraph);
        divDisplay.appendChild(span);
        divDisplay.appendChild(paragraph);
        divDisplay.appendChild(a);
        paragraph.appendChild(document.createTextNode(z.skills+ '\n'));
        span.appendChild(document.createTextNode(z.address + '\n'));
        paragraph.appendChild(document.createTextNode(z.datetime + '\n'));
        span.appendChild(document.createTextNode(z.type + '\n'));
        paragraph.appendChild(document.createTextNode(z.description + '\n'));
        span.appendChild(document.createTextNode(z.deadline + '\n'));
        paragraph.appendChild(document.createTextNode(z.application + '\n'));

        return li;
      }




      function displayAllPosts() {

        dbpostings.allDocs({include_docs: true, descending: true}).then(function (doc) {
          //alert(JSON.stringify(doc.rows));
          displayIndividualPosts(doc.rows);

        }).catch(function(err){
          console.log(err);
        });

      }

      displayAllPosts();

    </script>

  </body>
</html>


